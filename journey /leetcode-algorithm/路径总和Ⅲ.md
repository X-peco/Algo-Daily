#  [ğŸŒ³ è·¯å¾„æ€»å’Œâ…¢ MID](https://leetcode.cn/problems/path-sum-iii)

## ğŸ“ é¢˜ç›®æè¿°

> **ç»™å®šä¸€ä¸ªäºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹ `root` å’Œä¸€ä¸ªæ•´æ•°ç›®æ ‡å’Œ `targetSum`ï¼Œç»Ÿè®¡äºŒå‰æ ‘é‡Œè·¯å¾„å’Œç­‰äºç›®æ ‡å’Œçš„è·¯å¾„çš„æ•°ç›®ã€‚**
>
> è·¯å¾„ä¸éœ€è¦ä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œä¹Ÿä¸éœ€è¦åœ¨å¶å­èŠ‚ç‚¹ç»“æŸï¼Œä½†è·¯å¾„æ–¹å‘å¿…é¡»æ˜¯å‘ä¸‹çš„ï¼ˆåªèƒ½ä»çˆ¶èŠ‚ç‚¹åˆ°å­èŠ‚ç‚¹ï¼‰ã€‚

### ğŸ§© ç¤ºä¾‹è¾“å‡º

> **ç¤ºä¾‹ 1ï¼š**

![](https://assets.leetcode.com/uploads/2021/04/09/pathsum3-1-tree.jpg)

>**è¾“å…¥ï¼šroot = [10,5,-3,3,2,null,11,3,-2,null,1], targetSum = 8**
>
**è¾“å‡ºï¼š3**
>
**è§£é‡Šï¼šå’Œç­‰äº 8 çš„è·¯å¾„æœ‰ 3 æ¡ï¼Œå¦‚å›¾æ‰€ç¤º**

>**ç¤ºä¾‹ 2ï¼š**
>
**è¾“å…¥ï¼šroot = [5,4,8,11,null,13,4,7,2,null,null,5,1], targetSum = 22**
>
**è¾“å‡ºï¼š3**

---

## ğŸ’¡ æ€è·¯

**æœ¬é¢˜çš„æ ¸å¿ƒæ˜¯ï¼šç”¨å‰ç¼€å’Œ + å“ˆå¸Œè¡¨ç»Ÿè®¡è·¯å¾„å’Œã€‚**

- å’Œä¸€æ ·ï¼Œå¯ä»¥[å’Œä¸ºkçš„å­æ•°ç»„](https://github.com/X-peco/Algo-Daily/blob/main/journey%20/leetcode-algorithm/%E5%92%8C%E4%B8%BAk%E7%9A%84%E5%AD%90%E6%95%B0%E7%BB%84MID.md)ç”¨å‰ç¼€å’Œæ€æƒ³ï¼Œä½†å˜æˆäº†æ ‘ä¸Šçš„è·¯å¾„ã€‚
- é€’å½’éå†æ ‘ï¼Œç»´æŠ¤ä¸€æ¡ä»æ ¹åˆ°å½“å‰èŠ‚ç‚¹çš„è·¯å¾„çš„å‰ç¼€å’Œ pre_sum
- ç”¨å“ˆå¸Œè¡¨ `mp` è®°å½•ã€ŒæŸä¸ªå‰ç¼€å’Œ pre_sum å‡ºç°çš„æ¬¡æ•°ã€
- åˆ°è¾¾å½“å‰èŠ‚ç‚¹æ—¶ï¼Œè‹¥å­˜åœ¨ pre_sum - targetSumï¼Œåˆ™è¯´æ˜ä»æŸä¸ªç¥–å…ˆèŠ‚ç‚¹åˆ°å½“å‰èŠ‚ç‚¹çš„è·¯å¾„å’Œä¸º targetSum
- æ¯æ¬¡é€’å½’è¿”å›åï¼Œè¦å›æº¯ï¼ˆå³ mp[pre_sum] -= 1ï¼‰ï¼Œä»¥å…å½±å“åˆ°å…„å¼Ÿåˆ†æ”¯

### ğŸŒ³ å‰ç¼€å’Œåœ¨æ ‘ä¸Šçš„åº”ç”¨

| è·¯å¾„                     | èŠ‚ç‚¹å€¼ä¹‹å’Œ | è¯´æ˜                  |
| ------------------------ | ---------- | --------------------- |
| æ ¹ -> ... -> å½“å‰èŠ‚ç‚¹     | pre_sum    | å½“å‰è·¯å¾„å‰ç¼€å’Œ        |
| æŸç¥–å…ˆ -> ... -> å½“å‰èŠ‚ç‚¹ | pre_sum - old_sum = targetSum | ç¥–å…ˆèŠ‚ç‚¹ old_sum        |

**åˆå§‹åŒ–åŒæ ·éœ€è¦ `mp[0] = 1`ï¼Œè¡¨ç¤ºä»æ ¹èŠ‚ç‚¹å‡ºå‘ã€è·¯å¾„å’Œç­‰äº targetSum çš„æƒ…å†µã€‚**

---

## ğŸ§­ å‰ç¼€å’Œ + å“ˆå¸Œè¡¨ + DFS

<details>
  <summary><strong>ğŸ Python</strong></summary>

```python
class Solution:
    def pathSum(self, root, targetSum):
        from collections import defaultdict
        mp = defaultdict(int)
        mp[0] = 1

        def dfs(node, pre_sum):
            if not node:
                return 0
            pre_sum += node.val
            res = mp[pre_sum - targetSum]
            mp[pre_sum] += 1
            res += dfs(node.left, pre_sum)
            res += dfs(node.right, pre_sum)
            mp[pre_sum] -= 1  # å›æº¯
            return res

        return dfs(root, 0)
```
</details>

<details>
  <summary><strong>ğŸ¦• C++</strong></summary>

```cpp
class Solution {
public:
    int pathSum(TreeNode* root, int targetSum) {
        unordered_map<long long, int> mp;
        mp[0] = 1;
        function<int(TreeNode*, long long)> dfs = [&](TreeNode* node, long long pre_sum) -> int {
            if (!node) return 0;
            pre_sum += node->val;
            int res = mp[pre_sum - targetSum];
            mp[pre_sum]++;
            res += dfs(node->left, pre_sum);
            res += dfs(node->right, pre_sum);
            mp[pre_sum]--;
            return res;
        };
        return dfs(root, 0);
    }
};
```
</details>

---

## â±ï¸ å¤æ‚åº¦åˆ†æ

- *æ—¶é—´å¤æ‚åº¦ï¼šO(N)ï¼ŒN ä¸ºèŠ‚ç‚¹æ•°ï¼Œæ¯ä¸ªèŠ‚ç‚¹åªéå†ä¸€æ¬¡*

## â™¾ï¸DFSå†æ€è€ƒ
*DFSä¸éœ€è¦æ¯å±‚è¿”å›ï¼Œåˆ«çœ‹æ²¡æœ‰æ˜¾å¼å¾€ä¸Šå±‚ä¼ é€’ä¿¡æ¯ï¼Œä½†æ˜¯å®ƒæ¯å±‚ç»“å°¾éƒ½ä¼šæ¶ˆé™¤èµ°è¿‡çš„ç—•è¿¹*

`mp[pre_sum] -= 1`
`pre_sum -= node.val`

*è¿™ä¸¤éƒ¨åªæœ‰å½“å½“å‰è·¯å¾„èµ°åˆ°å¤´äº†ï¼Œåˆ†æ”¯ä¹Ÿèµ°åˆ°å¤´äº†ï¼Œæ‰ä¼šä»å°¾å·´å¼€å§‹åˆ é™¤*

---
